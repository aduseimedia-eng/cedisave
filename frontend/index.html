<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#006B3F">
  <title>KudiSave - Login</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/style.css">
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <!-- Lottie for animations -->
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <script>
    (function() {
      const hasSeenSplash = sessionStorage.getItem('splashShown');
      if (!hasSeenSplash) {
        sessionStorage.setItem('splashShown', 'true');
        window.location.href = 'splash.html';
      }
    })();
  </script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      padding: 0;
      padding-top: env(safe-area-inset-top, 0px);
      padding-bottom: env(safe-area-inset-bottom, 0px);
      background: #f8faf9;
      min-height: 100vh;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
    }

    /* ===== Animated Background ===== */
    .auth-bg {
      position: fixed;
      inset: 0;
      z-index: 0;
      background: linear-gradient(160deg, #f8faf9 0%, #eef5f1 30%, #f0f7f4 60%, #f5faf7 100%);
      overflow: hidden;
    }

    .auth-bg::before {
      content: '';
      position: absolute;
      top: -30%;
      right: -20%;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(0, 160, 94, 0.08) 0%, transparent 70%);
      border-radius: 50%;
      animation: floatOrb 20s ease-in-out infinite;
    }

    .auth-bg::after {
      content: '';
      position: absolute;
      bottom: -20%;
      left: -15%;
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, rgba(0, 107, 63, 0.06) 0%, transparent 70%);
      border-radius: 50%;
      animation: floatOrb 25s ease-in-out infinite reverse;
    }

    .bg-grid {
      position: absolute;
      inset: 0;
      background-image: 
        linear-gradient(rgba(0,107,63,0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,107,63,0.03) 1px, transparent 1px);
      background-size: 60px 60px;
      mask-image: radial-gradient(ellipse at center, black 30%, transparent 80%);
      -webkit-mask-image: radial-gradient(ellipse at center, black 30%, transparent 80%);
    }

    .floating-shape {
      position: absolute;
      border-radius: 50%;
      opacity: 0.5;
      filter: blur(1px);
    }

    .shape-1 {
      width: 6px; height: 6px;
      background: rgba(0, 160, 94, 0.35);
      top: 15%; left: 20%;
      animation: float1 12s ease-in-out infinite;
    }
    .shape-2 {
      width: 4px; height: 4px;
      background: rgba(252, 209, 22, 0.4);
      top: 25%; right: 25%;
      animation: float2 15s ease-in-out infinite;
    }
    .shape-3 {
      width: 8px; height: 8px;
      background: rgba(0, 160, 94, 0.25);
      bottom: 30%; left: 12%;
      animation: float3 18s ease-in-out infinite;
    }
    .shape-4 {
      width: 5px; height: 5px;
      background: rgba(252, 209, 22, 0.3);
      bottom: 20%; right: 15%;
      animation: float1 14s ease-in-out infinite reverse;
    }
    .shape-5 {
      width: 3px; height: 3px;
      background: rgba(0, 160, 94, 0.3);
      top: 60%; left: 35%;
      animation: float2 10s ease-in-out infinite;
    }

    @keyframes floatOrb {
      0%, 100% { transform: translate(0, 0) scale(1); }
      25% { transform: translate(30px, -40px) scale(1.05); }
      50% { transform: translate(-20px, 20px) scale(0.95); }
      75% { transform: translate(15px, 30px) scale(1.02); }
    }

    @keyframes float1 {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(20px, -30px); }
    }
    @keyframes float2 {
      0%, 100% { transform: translate(0, 0); }
      33% { transform: translate(-15px, 20px); }
      66% { transform: translate(10px, -10px); }
    }
    @keyframes float3 {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(-25px, -20px); }
    }

    /* ===== Main Container ===== */
    .auth-container {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 24px 20px;
      padding-top: calc(24px + env(safe-area-inset-top, 0px));
      padding-bottom: calc(24px + env(safe-area-inset-bottom, 0px));
    }

    /* ===== Glass Card ===== */
    .auth-card {
      background: #ffffff;
      border: 1px solid rgba(0, 0, 0, 0.06);
      border-radius: 24px;
      padding: 36px 28px 32px;
      max-width: 420px;
      width: 100%;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 40px rgba(0, 0, 0, 0.06), 0 2px 8px rgba(0, 0, 0, 0.04);
      animation: cardEnter 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards;
      opacity: 0;
      transform: translateY(30px);
    }

    .auth-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #006B3F, #00a05e, #006B3F);
    }

    @keyframes cardEnter {
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== Header ===== */
    .auth-header {
      text-align: center;
      margin-bottom: 32px;
    }

    .auth-logo-wrap {
      width: 72px;
      height: 72px;
      margin: 0 auto 16px;
      background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
      border-radius: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      animation: logoPulse 3s ease-in-out infinite;
    }

    .auth-logo-wrap::after {
      content: '';
      position: absolute;
      inset: -3px;
      border-radius: 25px;
      border: 1.5px solid rgba(0, 160, 94, 0.2);
      animation: logoRing 3s ease-in-out infinite;
    }

    .auth-logo-wrap i {
      width: 34px;
      height: 34px;
      color: #006B3F;
      stroke-width: 1.8;
    }

    @keyframes logoPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.04); }
    }

    @keyframes logoRing {
      0%, 100% { opacity: 0.5; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.06); }
    }

    .auth-title {
      font-size: 26px;
      font-weight: 800;
      color: #111827;
      letter-spacing: -0.5px;
      margin-bottom: 6px;
    }

    .auth-subtitle {
      color: #6b7280;
      font-size: 13px;
      font-weight: 400;
      line-height: 1.5;
    }

    /* ===== Pill Tab Switcher ===== */
    .auth-tabs {
      display: flex;
      background: #f3f4f6;
      border-radius: 14px;
      padding: 4px;
      margin-bottom: 28px;
      position: relative;
      border: 1px solid rgba(0, 0, 0, 0.04);
    }

    .tab-slider {
      position: absolute;
      top: 4px;
      left: 4px;
      width: calc(50% - 4px);
      height: calc(100% - 8px);
      background: linear-gradient(135deg, #00a05e, #006B3F);
      border-radius: 11px;
      transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 15px rgba(0, 160, 94, 0.3);
      z-index: 0;
    }

    .tab-slider.register {
      transform: translateX(100%);
    }

    .auth-tab {
      flex: 1;
      padding: 12px 16px;
      background: none;
      border: none;
      border-radius: 11px;
      color: #6b7280;
      cursor: pointer;
      transition: color 0.3s ease;
      font-weight: 600;
      font-size: 14px;
      text-align: center;
      position: relative;
      z-index: 1;
      touch-action: manipulation;
      font-family: inherit;
    }

    .auth-tab.active {
      color: #ffffff;
    }

    .auth-tab:active {
      transform: scale(0.97);
    }

    /* ===== Forms ===== */
    .auth-form {
      display: none;
    }

    .auth-form.active {
      display: block;
      animation: formFadeIn 0.35s ease;
    }

    @keyframes formFadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== Google Button ===== */
    .google-btn {
      width: 100%;
      padding: 13px 20px;
      background: #ffffff;
      border: 1.5px solid #e5e7eb;
      border-radius: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      font-size: 14px;
      font-weight: 500;
      color: #374151;
      transition: all 0.25s ease;
      font-family: inherit;
    }

    .google-btn:hover {
      background: #f9fafb;
      border-color: #d1d5db;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .google-btn:active {
      transform: scale(0.98);
    }

    .google-btn svg {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
    }

    /* ===== Divider ===== */
    .divider {
      display: flex;
      align-items: center;
      margin: 20px 0;
      gap: 14px;
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #e5e7eb;
    }

    .divider span {
      color: #9ca3af;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* ===== Form Groups ===== */
    .auth-form .form-group {
      margin-bottom: 18px;
      position: relative;
    }

    .auth-form .form-label {
      display: block;
      margin-bottom: 7px;
      font-weight: 600;
      color: #374151;
      font-size: 12px;
      letter-spacing: 0.3px;
    }

    .input-wrap {
      position: relative;
      display: flex;
      align-items: center;
    }

    .input-icon-left {
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      color: #9ca3af;
      pointer-events: none;
      transition: color 0.3s ease;
      z-index: 2;
    }

    .input-icon-left i {
      width: 18px;
      height: 18px;
      stroke-width: 2;
    }

    .auth-form .form-input {
      width: 100%;
      padding: 14px 14px 14px 44px;
      background: #f9fafb;
      border: 1.5px solid #e5e7eb;
      border-radius: 14px;
      color: #111827;
      font-size: 14px;
      font-family: inherit;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      -webkit-appearance: none;
      appearance: none;
    }

    .auth-form .form-input::placeholder {
      color: #9ca3af;
    }

    .auth-form .form-input:focus {
      outline: none;
      border-color: #00a05e;
      background: #ffffff;
      box-shadow: 0 0 0 3px rgba(0, 160, 94, 0.12), 0 4px 20px rgba(0, 160, 94, 0.06);
    }

    .auth-form .form-input:focus ~ .input-icon-left,
    .auth-form .form-input:not(:placeholder-shown) ~ .input-icon-left {
      color: #00a05e;
    }

    /* Password toggle */
    .password-toggle {
      position: absolute;
      right: 14px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #9ca3af;
      cursor: pointer;
      padding: 4px;
      display: flex;
      z-index: 2;
      transition: color 0.2s ease;
    }

    .password-toggle:hover {
      color: #6b7280;
    }

    .password-toggle i {
      width: 18px;
      height: 18px;
      stroke-width: 2;
    }

    .form-hint {
      display: block;
      margin-top: 6px;
      font-size: 11px;
      color: #9ca3af;
      padding-left: 2px;
    }

    /* ===== Password Strength ===== */
    .password-strength {
      display: flex;
      gap: 4px;
      margin-top: 8px;
    }

    .strength-bar {
      flex: 1;
      height: 3px;
      background: #e5e7eb;
      border-radius: 2px;
      transition: background 0.3s ease;
    }

    .strength-bar.weak { background: #ef4444; }
    .strength-bar.medium { background: #f59e0b; }
    .strength-bar.strong { background: #00a05e; }

    .strength-text {
      font-size: 10px;
      margin-top: 4px;
      font-weight: 500;
      transition: color 0.3s ease;
    }

    .strength-text.weak { color: #ef4444; }
    .strength-text.medium { color: #f59e0b; }
    .strength-text.strong { color: #00a05e; }

    /* ===== Forgot Password ===== */
    .forgot-link {
      display: block;
      text-align: right;
      font-size: 12px;
      color: #006B3F;
      text-decoration: none;
      font-weight: 500;
      margin-top: -8px;
      margin-bottom: 20px;
      transition: color 0.2s ease;
    }

    .forgot-link:hover {
      color: #00a05e;
    }

    /* ===== Submit Buttons ===== */
    .auth-submit {
      width: 100%;
      padding: 15px 24px;
      background: linear-gradient(135deg, #00a05e 0%, #006B3F 100%);
      color: white;
      border: none;
      border-radius: 14px;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      font-family: inherit;
      letter-spacing: -0.1px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 4px 20px rgba(0, 160, 94, 0.25);
    }

    .auth-submit::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, transparent, rgba(255,255,255,0.15), transparent);
      transform: translateX(-100%);
      transition: transform 0.5s ease;
    }

    .auth-submit:hover::before {
      transform: translateX(100%);
    }

    .auth-submit:active {
      transform: scale(0.98);
      box-shadow: 0 2px 10px rgba(0, 160, 94, 0.25);
    }

    .auth-submit.loading {
      pointer-events: none;
      opacity: 0.85;
    }

    .auth-submit .btn-text {
      transition: opacity 0.2s ease;
    }

    .auth-submit.loading .btn-text {
      opacity: 0;
    }

    .auth-submit .btn-spinner {
      position: absolute;
      width: 22px;
      height: 22px;
      border: 2.5px solid rgba(255,255,255,0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.7s linear infinite;
      display: none;
    }

    .auth-submit.loading .btn-spinner {
      display: block;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }



    /* ===== Footer ===== */
    .auth-footer {
      text-align: center;
      margin-top: 28px;
      padding-top: 20px;
      border-top: 1px solid #f3f4f6;
    }

    .auth-footer p {
      color: #9ca3af;
      font-size: 12px;
      font-weight: 400;
      line-height: 1.5;
    }

    .auth-footer .secure-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #006B3F;
      font-size: 11px;
      font-weight: 500;
      margin-top: 8px;
    }

    .auth-footer .secure-badge i {
      width: 13px;
      height: 13px;
      stroke-width: 2.5;
    }

    /* ===== Toast ===== */
    .toast {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      padding: 14px 24px;
      border-radius: 16px;
      z-index: 10000;
      font-size: 13px;
      font-weight: 600;
      font-family: inherit;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      gap: 10px;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.4s ease;
      opacity: 0;
      max-width: calc(100vw - 40px);
    }

    .toast.visible {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    .toast.success {
      background: rgba(0, 107, 63, 0.9);
      border: 1px solid rgba(0, 160, 94, 0.3);
      color: white;
    }

    .toast.error {
      background: rgba(220, 53, 69, 0.9);
      border: 1px solid rgba(220, 53, 69, 0.3);
      color: white;
    }

    .toast.warning {
      background: rgba(245, 158, 11, 0.9);
      border: 1px solid rgba(245, 158, 11, 0.3);
      color: white;
    }

    .toast i {
      width: 18px;
      height: 18px;
      stroke-width: 2.5;
      flex-shrink: 0;
    }

    /* ===== Splash Overlay ===== */
    .splash-overlay {
      position: fixed;
      inset: 0;
      background: #006B3F;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.6s ease, visibility 0.6s ease;
    }

    .splash-overlay.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .splash-overlay .splash-logo {
      margin-bottom: 12px;
      animation: bounceIn 0.6s ease;
      color: #00e676;
    }

    .splash-overlay .splash-logo i {
      width: 50px;
      height: 50px;
      stroke-width: 1.5;
    }

    .splash-overlay .splash-title {
      font-size: 22px;
      font-weight: 800;
      color: white;
      margin-bottom: 4px;
    }

    .splash-overlay .splash-subtitle {
      font-size: 12px;
      color: rgba(255,255,255,0.5);
      margin-bottom: 24px;
    }

    .splash-overlay .splash-loader {
      display: flex;
      gap: 8px;
    }

    .splash-overlay .splash-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #00a05e;
      animation: pulse 1.4s ease-in-out infinite;
    }

    .splash-overlay .splash-dot:nth-child(1) { animation-delay: 0s; }
    .splash-overlay .splash-dot:nth-child(2) { animation-delay: 0.2s; }
    .splash-overlay .splash-dot:nth-child(3) { animation-delay: 0.4s; }

    @keyframes bounceIn {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.05); }
      70% { transform: scale(0.9); }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(0.8); opacity: 0.5; }
      50% { transform: scale(1.2); opacity: 1; }
    }



    /* ===== Responsive ===== */
    @media (max-width: 440px) {
      .auth-card {
        padding: 28px 20px 24px;
        border-radius: 20px;
      }
      .auth-logo-wrap {
        width: 64px;
        height: 64px;
        border-radius: 18px;
      }
      .auth-title {
        font-size: 22px;
      }
    }

    @media (max-width: 360px) {
      .auth-card {
        padding: 24px 16px 20px;
      }
    }

    /* ===== Landscape safety ===== */
    @media (max-height: 600px) {
      .auth-container { justify-content: flex-start; padding-top: 16px; }
      .auth-header { margin-bottom: 20px; }
      .auth-logo-wrap { width: 56px; height: 56px; margin-bottom: 12px; }
    }
  </style>
</head>
<body>
  <!-- Animated Background -->
  <div class="auth-bg">
    <div class="bg-grid"></div>
    <div class="floating-shape shape-1"></div>
    <div class="floating-shape shape-2"></div>
    <div class="floating-shape shape-3"></div>
    <div class="floating-shape shape-4"></div>
    <div class="floating-shape shape-5"></div>
  </div>

  <!-- Splash Overlay -->
  <div class="splash-overlay hidden" id="splashOverlay">
    <div class="splash-logo"><i data-lucide="landmark"></i></div>
    <h1 class="splash-title">KudiSave</h1>
    <p class="splash-subtitle">Welcome back!</p>
    <div class="splash-loader">
      <div class="splash-dot"></div>
      <div class="splash-dot"></div>
      <div class="splash-dot"></div>
    </div>
  </div>

  <!-- Main Auth Container -->
  <div class="auth-container">
    <div class="auth-card">

      <!-- Header -->
      <div class="auth-header">
        <div class="auth-logo-wrap">
          <i data-lucide="landmark"></i>
        </div>
        <h1 class="auth-title">KudiSave</h1>
        <p class="auth-subtitle">Master your finances, one cedi at a time</p>
      </div>

      <!-- Tab Switcher -->
      <div class="auth-tabs">
        <div class="tab-slider" id="tabSlider"></div>
        <button class="auth-tab active" onclick="switchTab('login')" id="tabLogin">Sign In</button>
        <button class="auth-tab" onclick="switchTab('register')" id="tabRegister">Sign Up</button>
      </div>

      <!-- ==================== LOGIN FORM ==================== -->
      <form id="loginForm" class="auth-form active" onsubmit="handleLogin(event)">
        <!-- Google -->
        <button type="button" class="google-btn" onclick="signInWithGoogle()">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
          </svg>
          Continue with Google
        </button>

        <div class="divider"><span>or</span></div>

        <!-- Email / Phone -->
        <div class="form-group">
          <label class="form-label">Email or Phone</label>
          <div class="input-wrap">
            <input 
              type="text" 
              class="form-input" 
              id="loginIdentifier" 
              placeholder="kwame@example.com"
              required
              autocomplete="email"
            >
            <span class="input-icon-left"><i data-lucide="mail"></i></span>
          </div>
        </div>

        <!-- Password -->
        <div class="form-group">
          <label class="form-label">Password</label>
          <div class="input-wrap">
            <input 
              type="password" 
              class="form-input" 
              id="loginPassword" 
              placeholder="Enter your password"
              required
              autocomplete="current-password"
            >
            <span class="input-icon-left"><i data-lucide="lock"></i></span>
            <button type="button" class="password-toggle" onclick="togglePassword('loginPassword', this)" aria-label="Toggle password visibility">
              <i data-lucide="eye"></i>
            </button>
          </div>
        </div>

        <a href="#" class="forgot-link" onclick="handleForgotPassword(event)">Forgot password?</a>

        <!-- Submit -->
        <button type="submit" class="auth-submit" id="loginBtn">
          <span class="btn-text">Sign In</span>
          <div class="btn-spinner"></div>
        </button>

      </form>

      <!-- ==================== REGISTER FORM ==================== -->
      <form id="registerForm" class="auth-form" onsubmit="handleRegister(event)">
        <!-- Google -->
        <button type="button" class="google-btn" onclick="signInWithGoogle()">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
          </svg>
          Sign up with Google
        </button>

        <div class="divider"><span>or</span></div>

        <!-- Full Name -->
        <div class="form-group">
          <label class="form-label">Full Name</label>
          <div class="input-wrap">
            <input 
              type="text" 
              class="form-input" 
              id="registerName" 
              placeholder="Kwame Mensah"
              required
              autocomplete="name"
            >
            <span class="input-icon-left"><i data-lucide="user"></i></span>
          </div>
        </div>

        <!-- Email -->
        <div class="form-group">
          <label class="form-label">Email</label>
          <div class="input-wrap">
            <input 
              type="email" 
              class="form-input" 
              id="registerEmail" 
              placeholder="kwame@example.com"
              required
              autocomplete="email"
            >
            <span class="input-icon-left"><i data-lucide="mail"></i></span>
          </div>
        </div>

        <!-- Phone -->
        <div class="form-group">
          <label class="form-label">Phone (Ghana)</label>
          <div class="input-wrap">
            <input 
              type="tel" 
              class="form-input" 
              id="registerPhone" 
              placeholder="233244123456"
              pattern="233[0-9]{9}"
              required
              autocomplete="tel"
            >
            <span class="input-icon-left"><i data-lucide="phone"></i></span>
          </div>
          <span class="form-hint">Format: 233XXXXXXXXX</span>
        </div>

        <!-- Password -->
        <div class="form-group">
          <label class="form-label">Password</label>
          <div class="input-wrap">
            <input 
              type="password" 
              class="form-input" 
              id="registerPassword" 
              placeholder="Min. 8 characters"
              minlength="8"
              required
              autocomplete="new-password"
              oninput="checkPasswordStrength(this.value)"
            >
            <span class="input-icon-left"><i data-lucide="lock"></i></span>
            <button type="button" class="password-toggle" onclick="togglePassword('registerPassword', this)" aria-label="Toggle password visibility">
              <i data-lucide="eye"></i>
            </button>
          </div>
          <div class="password-strength" id="passwordStrength" style="display:none;">
            <div class="strength-bar" id="str1"></div>
            <div class="strength-bar" id="str2"></div>
            <div class="strength-bar" id="str3"></div>
            <div class="strength-bar" id="str4"></div>
          </div>
          <span class="strength-text" id="strengthText"></span>
        </div>

        <!-- Submit -->
        <button type="submit" class="auth-submit" id="registerBtn">
          <span class="btn-text">Create Account</span>
          <div class="btn-spinner"></div>
        </button>
      </form>

      <!-- Footer -->
      <div class="auth-footer">
        <p>Helping Ghanaian youth build better financial habits</p>
        <div class="secure-badge">
          <i data-lucide="shield-check"></i>
          256-bit encrypted &bull; Your data is safe
        </div>
      </div>
    </div>
  </div>

  <script src="assets/js/config.js"></script>
  <script src="assets/js/api.js"></script>
  <script src="assets/js/utils.js"></script>
  <script>
    // ===== Redirect first-time visitors =====
    (function() {
      const hasVisited = localStorage.getItem('kudisave_visited');
      const isLoggedIn = localStorage.getItem('token');
      if (!hasVisited && !isLoggedIn) {
        localStorage.setItem('kudisave_visited', 'true');
        window.location.href = 'splash.html';
        return;
      }
    })();

    console.log('Login page loaded successfully!');

    // ===== Toast System =====
    let activeToast = null;
    function showToast(message, type = 'success') {
      if (activeToast) activeToast.remove();

      const iconMap = { success: 'check-circle', error: 'alert-circle', warning: 'alert-triangle' };
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `<i data-lucide="${iconMap[type] || 'info'}"></i><span>${message}</span>`;
      document.body.appendChild(toast);
      lucide.createIcons({ nodes: [toast] });
      activeToast = toast;

      requestAnimationFrame(() => {
        requestAnimationFrame(() => toast.classList.add('visible'));
      });

      setTimeout(() => {
        toast.classList.remove('visible');
        setTimeout(() => { toast.remove(); if (activeToast === toast) activeToast = null; }, 400);
      }, 3500);
    }

    // ===== Tab Switching =====
    function switchTab(tab) {
      const slider = document.getElementById('tabSlider');
      const tabs = document.querySelectorAll('.auth-tab');
      const forms = document.querySelectorAll('.auth-form');

      tabs.forEach(t => t.classList.remove('active'));
      forms.forEach(f => f.classList.remove('active'));

      if (tab === 'login') {
        slider.classList.remove('register');
        document.getElementById('tabLogin').classList.add('active');
        document.getElementById('loginForm').classList.add('active');
      } else {
        slider.classList.add('register');
        document.getElementById('tabRegister').classList.add('active');
        document.getElementById('registerForm').classList.add('active');
      }
    }

    // ===== Password Toggle =====
    function togglePassword(inputId, btn) {
      const input = document.getElementById(inputId);
      const icon = btn.querySelector('i');
      if (input.type === 'password') {
        input.type = 'text';
        icon.setAttribute('data-lucide', 'eye-off');
      } else {
        input.type = 'password';
        icon.setAttribute('data-lucide', 'eye');
      }
      lucide.createIcons({ nodes: [btn] });
    }

    // ===== Password Strength =====
    function checkPasswordStrength(value) {
      const container = document.getElementById('passwordStrength');
      const text = document.getElementById('strengthText');
      const bars = [document.getElementById('str1'), document.getElementById('str2'), document.getElementById('str3'), document.getElementById('str4')];

      if (!value) {
        container.style.display = 'none';
        text.textContent = '';
        return;
      }
      container.style.display = 'flex';

      let score = 0;
      if (value.length >= 8) score++;
      if (/[a-z]/.test(value) && /[A-Z]/.test(value)) score++;
      if (/[0-9]/.test(value)) score++;
      if (/[^a-zA-Z0-9]/.test(value)) score++;

      const levels = ['', 'weak', 'medium', 'medium', 'strong'];
      const labels = ['', 'Weak', 'Fair', 'Good', 'Strong'];
      const level = levels[score];

      bars.forEach((bar, i) => {
        bar.className = 'strength-bar';
        if (i < score) bar.classList.add(level);
      });

      text.className = `strength-text ${level}`;
      text.textContent = labels[score];
    }

    // ===== Button Loading State =====
    function setLoading(btnId, loading) {
      const btn = document.getElementById(btnId);
      if (loading) {
        btn.classList.add('loading');
      } else {
        btn.classList.remove('loading');
      }
    }

    // ===== Forgot Password =====
    function handleForgotPassword(e) {
      e.preventDefault();
      const identifier = document.getElementById('loginIdentifier').value;
      if (!identifier) {
        showToast('Enter your email first, then click forgot password', 'warning');
        document.getElementById('loginIdentifier').focus();
        return;
      }
      // TODO: Wire up to password reset API
      showToast('Password reset link sent to your email!', 'success');
    }

    // ===== Google Sign-In =====
    const GOOGLE_CLIENT_ID = 'YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com';

    function initGoogleSignIn() {
      if (typeof google !== 'undefined' && google.accounts) {
        google.accounts.id.initialize({
          client_id: GOOGLE_CLIENT_ID,
          callback: handleGoogleCallback,
          auto_select: false,
          cancel_on_tap_outside: true
        });
      }
    }

    function signInWithGoogle() {
      if (typeof google !== 'undefined' && google.accounts) {
        google.accounts.id.prompt((notification) => {
          if (notification.isNotDisplayed()) {
            google.accounts.oauth2.initTokenClient({
              client_id: GOOGLE_CLIENT_ID,
              scope: 'email profile',
              callback: (response) => {
                if (response.access_token) fetchGoogleUserInfo(response.access_token);
              }
            }).requestAccessToken();
          }
        });
      } else {
        console.log('Google SDK not loaded');
        showToast('Google Sign-In is not available right now', 'error');
      }
    }

    async function fetchGoogleUserInfo(accessToken) {
      try {
        const response = await fetch('https://www.googleapis.com/oauth2/v2/userinfo', {
          headers: { Authorization: `Bearer ${accessToken}` }
        });
        const userInfo = await response.json();
        completeGoogleLogin(userInfo);
      } catch (error) {
        console.error('Error fetching Google user info:', error);
        showToast('Failed to get Google account info', 'error');
      }
    }

    function handleGoogleCallback(response) {
      if (response.credential) {
        const userInfo = parseJwt(response.credential);
        completeGoogleLogin(userInfo);
      }
    }

    function parseJwt(token) {
      try {
        const base64Url = token.split('.')[1];
        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        return JSON.parse(window.atob(base64));
      } catch (e) { return {}; }
    }

    function completeGoogleLogin(userInfo) {
      const user = {
        name: userInfo.name || userInfo.given_name || 'Google User',
        email: userInfo.email,
        picture: userInfo.picture,
        provider: 'google',
        googleId: userInfo.sub || userInfo.id
      };
      localStorage.setItem('token', 'google-auth-' + Date.now());
      localStorage.setItem('user', JSON.stringify(user));
      localStorage.setItem('onboardingComplete', 'true');
      showToast('Signed in with Google!');
      setTimeout(() => { window.location.href = 'pages/dashboard.html'; }, 500);
    }



    // ===== Handle Login =====
    async function handleLogin(event) {
      event.preventDefault();
      const identifier = document.getElementById('loginIdentifier').value.trim();
      const password = document.getElementById('loginPassword').value;

      if (!identifier || !password) {
        showToast('Please fill in all fields', 'error');
        return;
      }

      setLoading('loginBtn', true);
      try {
        const result = await api.login({ identifier, password });
        if (result.success) {
          showToast('Welcome back!');
          setTimeout(() => { window.location.href = 'pages/dashboard.html'; }, 500);
        }
      } catch (error) {
        console.error('Login error:', error);
        if (error.status === 403 && error.response?.data?.requiresPhoneVerification) {
          showToast('Phone verification required. Redirecting...', 'warning');
          const phone = error.response.data.phone;
          sessionStorage.setItem('pendingPhoneVerification', phone);
          setTimeout(() => { window.location.href = 'verify-phone.html'; }, 1000);
        } else {
          showToast(error.message || 'Login failed. Check your credentials.', 'error');
        }
      } finally {
        setLoading('loginBtn', false);
      }
    }

    // ===== Handle Register =====
    async function handleRegister(event) {
      event.preventDefault();
      const name = document.getElementById('registerName').value.trim();
      const email = document.getElementById('registerEmail').value.trim();
      const phone = document.getElementById('registerPhone').value.trim();
      const password = document.getElementById('registerPassword').value;

      if (!name || !email || !phone || !password) {
        showToast('Please fill in all fields', 'error');
        return;
      }

      if (!phone.match(/^233[0-9]{9}$/)) {
        showToast('Phone must be Ghana format: 233XXXXXXXXX', 'error');
        return;
      }

      if (password.length < 8) {
        showToast('Password must be at least 8 characters', 'error');
        return;
      }

      setLoading('registerBtn', true);
      try {
        const result = await api.register({ name, email, phone, password });
        if (result.success) {
          if (result.data.requiresPhoneVerification) {
            showToast('Account created! Verify your phone.');
            sessionStorage.setItem('pendingPhoneVerification', phone);
            setTimeout(() => { window.location.href = 'verify-phone.html'; }, 500);
          } else {
            showToast('Account created successfully!');
            setTimeout(() => { window.location.href = 'pages/dashboard.html'; }, 500);
          }
        }
      } catch (error) {
        console.error('Registration error:', error);
        showToast(error.message || 'Registration failed', 'error');
      } finally {
        setLoading('registerBtn', false);
      }
    }

    // ===== Init =====
    document.addEventListener('DOMContentLoaded', () => {
      console.log('DOM loaded');
      lucide.createIcons();

      // Already logged in? Go to dashboard
      const token = localStorage.getItem('token');
      if (token) {
        window.location.href = 'pages/dashboard.html';
        return;
      }

      // Init Google Sign-In
      setTimeout(initGoogleSignIn, 500);

      // Hide splash overlay
      setTimeout(() => {
        const splash = document.getElementById('splashOverlay');
        if (splash) splash.classList.add('hidden');
      }, 800);
    });
  </script>
</body>
</html>
